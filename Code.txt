'Olive Mckenze Challenge 2 Excel VBA code

Sub Stock()
  ' Set an initial variable for Ticker name
    Dim Ticker_Name As String
    Dim Ticker_Name1 As String
    Dim Ticker_Name2 As String
    Dim Ticker_Name3 As String
    
    Dim YearlyChange As Double
    YearlyChange = 0
    Dim TickerYearStartValue As Double
    TickerYearStartValue = 0
    Dim TickerYearEndValue As Double
    TickerYearEndValue = 0
    Dim FirstTickerOpenValue As Double
    FirstTickerOpenValue = 0
    Dim TickerCount As Integer
    TickerCount = 0
    Dim Percent_Change As Double
    Percent_Change = 0
    Dim GreatestPercentIncrease As Double
    GreatestPercentIncrease = 0
    Dim GreatestPercentDecrease As Double
    GreatestPercentIncrease = 0
    
    Dim GreatestVolumeValue As Double
    GreatestVolumeValue = 0
   
  ' Set an initial variable for holding the Total_Stock_Volume
  Dim Total_Stock_Volume As Double
  Total_Stock_Volume = 0
  ' Keep track of the location for each Ticker in the summary table
  Dim Summary_Table_Row As Integer
  Summary_Table_Row = 2
  Dim LastRow As Long
  'Printing Header Names
    Range("K1").Value = "Ticker"
   Range("L1").Value = "YearlyChange"
   Range("M1").Value = "Percent_Change"
    Range("N1").Value = "Total_Stock_Volume"
    Range("P1").Value = "Ticker"
    Range("Q1").Value = "Value"
    Range("O2").Value = "Greatest % Increase"
    Range("O3").Value = "Greatest % Decrease"
    Range("O4").Value = "Greatest Total Volume"
  'Find the last non-blank cell in column A(1)
    LastRow = Cells(Rows.Count, 1).End(xlUp).Row
    
  ' Loop through all Ticker names
  For i = 2 To LastRow
    If i = 2 Then
        TickerYearStartValue = Cells(i, 3).Value
       'MsgBox FirstTickerOpenValue
    End If
    ' Check if we are still within the same Ticker Name
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
      ' Set Ticker Name
      Ticker_Name = Cells(i, 1).Value
      TickerYearEndValue = Cells(i, 6).Value
            
            YearlyChange = TickerYearEndValue - TickerYearStartValue
            Range("L" & Summary_Table_Row).Value = YearlyChange
            Percent_Change = (YearlyChange / TickerYearStartValue) * 100
            
             Range("M" & Summary_Table_Row).Value = Percent_Change & "%"
              TickerYearStartValue = Cells(i + 1, 3).Value
      'Print Ticker; Names in row K
       Range("K" & Summary_Table_Row).Value = Ticker_Name
      ' Add to Total Stock Volume
        Total_Stock_Volume = Total_Stock_Volume + Cells(i, 7).Value
       
      ' Print the Total_Stock_Volume to the Summary Table
        Range("N" & Summary_Table_Row).Value = Total_Stock_Volume
        
        ' Add one to the summary table row
        Summary_Table_Row = Summary_Table_Row + 1
        
        If GreatestPercentIncrease < Percent_Change Then
            GreatestPercentIncrease = Percent_Change
           Ticker_Name1 = Ticker_Name
            Cells(2, 16).Value = Ticker_Name1
            Cells(2, 17).Value = GreatestPercentIncrease
            
            
        End If
        
        If GreatestPercentDecrease > Percent_Change Then
                    GreatestPercentDecrease = Percent_Change
                   Ticker_Name2 = Ticker_Name
                   Cells(3, 16).Value = Ticker_Name2
                   Cells(3, 17).Value = GreatestPercentDecrease
            
        End If
        
       If GreatestVolumeValue < Total_Stock_Volume Then
            GreatestVolumeValue = Total_Stock_Volume
            Ticker_Name3 = Ticker_Name
            Cells(4, 16).Value = Ticker_Name3
            Cells(4, 17).Value = GreatestVolumeValue
        End If
        
        

     
        Total_Stock_Volume = 0
        YearlyChange = 0
        WorkingRow = WorkingRow + 1
        Else
        ' Add to the Stock Volume Total
        Total_Stock_Volume = Total_Stock_Volume + Cells(i, 7).Value
    End If
     ' Color Red if YearlyChange less than 0
     If Cells(i, 12).Value < 0 Then
        Cells(i, 12).Interior.ColorIndex = 3
     Else
     ' Color Green if YearlyChange greater than 0
       Cells(i, 12).Interior.ColorIndex = 4
     End If
  Next i
End Sub

